---
title: API
slug: /devportal/api
tags:
- API7 Enterprise
---

## 名词解释

### API
对应API7网关上的路由。

### 目录
目录一般用于 API 分类，如将属于同一模块或功能相关的 API 放在同一目录下，开发者可以基于目录快速查找 API。每个 API 只能属于一个目录。

**特殊说明**：当前仅支持 `default` 目录，后续将支持新增和管理自定义目录。

### API 名称
帮助用户识别并了解 API。

### API 描述
帮助用户快速了解 API 的作用及注意事项。

### 更新时间
最后一次编辑 API 并成功生效的时间，时区为当前集群所属时区。

### 关联集群/关联路由
发布到开发者门户的 API 必须和 API7 网关中已有的路由相关关联。路由所在的集群即为此 API 所关联的集群。

开发者门户中的 API 与其关联路由是实时联动的，如果在 API7 网关中修改了该路由，或者更换该 API 所关联的路由，则会立刻影响对应 API 的行为和用法。因此当 API 关联的路由发生调整时，请及时修改对应 API 文档并通知订阅的开发者。

### 认证方式
API 的关联路由上如果开启了认证类插件，则需要开发者需要按照对应的方式认证才可调用此 API。

**特殊说明**：当前仅支持 `key-auth` 认证方式，后续将支持更多。

### API订阅
开发者可以以[应用](https://docs.apiseven.com/enterprise/devportal/application#应用)为主体申请订阅 API。即 API 的调用许可和凭证，不属于某个特定的开发者，而是应该根据业务划分，属于某个应用。

订阅成功后应用方可调用此 API。如果 API 开启了认证，则应用会获得对应的访问凭证。
对于同一个 API，不同应用的访问凭证是不同的，但对于同一个应用，如果订阅了多个使用同样认证方式的 API，则对应的访问凭证是一样的。如果取消某个应用对当前 API 的订阅，则此应用的访问凭证会失效。

每个应用会映射 API7 网关中的一个消费者（Consumer）；每条 API 订阅成功，会映射为在该 API 的关联路由中，将对应的消费者（Consumer）添加入访问白名单中；取消 API 订阅，会映射为在该 API 的关联路由中，从访问白名单里删除对应的消费者（Consumer）。因此，如果在 API7 网关侧直接更改了 API 关联路由中的访问白名单，会破坏 API 订阅关系，引起错误。

**特殊说明**：
1. 若API没有开启任何认证，实际上任何应用都可以直接访问，不需要订阅。
2. 暂不支持已经订阅成功的应用更换访问凭证。

### 组织名称
[什么是组织名称](https://docs.apiseven.com/enterprise/devportal/developer#组织名称)。

### 应用名称
[什么是应用名称](https://docs.apiseven.com/enterprise/devportal/developer#组织)。

## 新增 API
#### 使用场景
将一个新的 API 发布到开发者门户，让开发者可以查看 API 介绍与文档，并订阅 API。

#### 使用限制
- API 必须关联 API7 网关中已有的路由，且路由上已配置好必须的插件。
- 新增 API 需要提前准备好 OpenAPI Spec 文档。

#### 操作步骤
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤3**：在左侧菜单，点击「API」。

**步骤4**： 点击「新增 API」按钮。

**步骤5**：参照名词解释填写表单。

**步骤6**：点击「提交」按钮。

**验证方式**：在 API 列表中可以查看到新增成功的 API。

## 删除 API
#### 使用场景
当 API 下线或者废弃时，删除 API。

#### 使用限制
- 删除 API 后，之前订阅此 API 的开发者将立刻无法继续调用。请务必确保没有业务影响后再操作
- 删除的 API 无法恢复，需要重新添加，开发者也需要重新订阅。
- 从开发者门户删除 API，仅仅是指从开发者门户产生的订阅不再有效，也无法通过开发者门户产生新的订阅，不会连带从 API7 网关删除关联路由/API，也不会影响您通过其他方式向开发者发放的 API key。

#### 操作步骤
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤3**：在左侧菜单，点击「API」。

**步骤4**：选择目标 API，点击对应的 「删除」 按钮。

**验证方式**：在API 列表中无法查看到该 API。

## 新增 API 订阅
#### 使用场景
- 由管理员在管理端对应用直接进行 API 订阅，免去审批流程。也可以用于预置 API 的初始调用方。
- 由开发者在展示端以应用为主体发起 API 订阅申请，需要管理员审批同意。

#### 使用限制
- 必须先由开发者创建应用。API 无法脱离应用，直接被特定开发者订阅或使用。
- 通过开发者门户进行 API 的订阅管理不是唯一的途径。您也可以在 API7 网关中，通过操作消费者、插件实现同样的效果。但非通过开发者门户新增的 API 订阅，或者直接操作 API7 网关中消费者与插件，从而使得开发者可以通过访问凭证调用 API，不会呈现在开发者门户中。

#### 操作步骤-管理员发起
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤3**：在左侧菜单，点击「应用」。

**步骤4**：选择需要进行 API 订阅的应用，点击对应的「查看」按钮。

**步骤5**：点击 「新增 API 订阅」按钮。

**步骤6**：选择需要订阅的 API.

**步骤7**：点击 「确定」按钮。

**步骤8**：也可以在左侧菜单，点击「API」 。

**步骤9**：选择需要订阅的 API，点击对应的「查看」按钮。

**步骤10**：点击「新增 API 订阅」按钮。

**步骤11**：选择需要订阅的应用。

**步骤12**： 点击「确定」按钮。

**验证方式**：
- 在应用下 API 订阅列表中，可以查看到新增的 API 订阅条目。、
- 在 API 下的订阅列表中，可以查看到新增的已订阅应用。
- 开发者使用该应用的访问凭证，可以成功调用此 API。

#### 操作步骤-开发者发起
**步骤1**：从展示端发起 API 订阅申请。

**步骤2**：等待管理员审批同意。

**验证方式**：
开发者使用该应用的访问凭证，可以成功调用此 API。

## 取消 API 订阅
#### 使用场景
- 由管理员在管理端对某个应用下的 API 进行取消订阅，应用对该 API 的访问凭证失效。
- 由开发者在展示端进行取消 API 订阅操作，无需管理员审批同意。

#### 使用限制
- 取消 API 订阅，仅限取消从开发者门户成功产生的 API 订阅记录。如果是在 API7 网关上手动修改过 API 订阅相关的消费者或者插件，无法反映在开发者门户中。
- 取消后开发者仍可重新发起订阅申请。

#### 操作步骤-管理员发起
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤3**：在左侧菜单，点击「应用」。

**步骤4**：选择需要取消的 API 订阅，点击对应的「取消订阅」按钮。

**步骤5**：也可以在左侧菜单，点击「API」 。

**步骤6**：选择需要取消订阅的 API，点击对应的「查看」按钮。

**步骤7**：选择需要取消订阅的应用，点击对应的「取消订阅」按钮。

**验证方式**：
- 在应用下 API 订阅列表中，看不到已被取消订阅的 API。
- 在 API 下的订阅列表中，看不到已经取消的应用。
- 开发者使用该应用的访问凭证，已无法调用此 API。

#### 操作步骤-开发者发起
**步骤1**：从展示端发起取消 API 订阅申请。

**验证方式**：
开发者使用该应用的访问凭证，已无法调用此 API。

## 同意 API 订阅申请
#### 使用场景
开发者以应用为主体对某条 API 提出订阅申请，管理员同意该应用的订阅申请，应用获得 API key（如果 API 开启了认证）。

#### 使用限制
- 如果 API 本身没有开启认证类插件，本身不需要 API key 即可调用，那本质上是否同意 API 订阅申请并不影响可以直接调用此 API。
- 后续会加入主动通知管理员有审批待处理。

#### 操作步骤
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤5**：也可以在左侧菜单，点击「API」 。

**步骤6**：选择需要同意订阅的 API，点击对应的「查看」按钮。

**步骤7**：选择需要同意订阅的应用，点击对应的「同意」按钮。

**验证方式**：
- 在应用下 API 订阅列表中，可以查看到新增的 API 订阅条目。、
- 在 API 下的订阅列表中，可以查看到新增的已订阅应用。
- 开发者使用该应用的访问凭证，可以成功调用此 API。

## 拒绝 API 订阅申请

#### 使用场景
开发者以应用为主体对某条 API 提出订阅申请，管理员拒绝该应用的订阅申请，应用无法调用此 API。

#### 使用限制
- 如果 API 本身没有开启认证类插件，本身不需要 API key 即可调用，那本质上是否拒绝 API 订阅申请并不影响可以直接调用此 API。
- 后续会加入主动通知管理员有审批待处理。

#### 操作步骤
**步骤1**：登录 API7 Enterprise 控制台。

**步骤2**：在顶部导航菜单，点击「开发者门户」。

**步骤5**：也可以在左侧菜单，点击「API」 。

**步骤6**：选择需要拒绝订阅的 API，点击对应的「查看」按钮。

**步骤7**：选择需要拒绝订阅的应用，点击对应的「拒绝」按钮。

**验证方式**：
- 在应用下 API 列表页中，该 API 订阅记录显示状态为拒绝。
- 开发者使用该应用的访问凭证，无法调用此 API。